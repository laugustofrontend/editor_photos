var _this=this;const screenSize={width:document.querySelector('.screen').clientWidth-17,height:900},config=(a,b,c)=>{const d=document.querySelector(`${a}`),e=d.getContext('2d');return d.setAttribute('width',b),d.setAttribute('height',c),{context:e,canvas:d}},mousePosition=(a,b)=>{let c=a,d=0,e=0;for(;c&&'body'!==c.tagName;)d+=c.offsetTop,e+=c.offsetLeft,c=c.offsetParent;let f=b.clientX-(e+window.pageXOffset),g=b.clientY-(d+window.pageYOffset);return{x:f,y:g}},drawFree=(a,b)=>{const c=[];let d=!1;a.onmousedown=(a)=>{'free'!==drawing||(b.moveTo(a.clientX,a.clientY),d=!0)},a.onmouseup=()=>{return d=!1},a.onmousemove=(a)=>{d&&'free'===drawing&&(b.lineTo(a.clientX,a.clientY),b.stroke(),c.push({x:a.clientX,y:a.clientY}))}},drawPin=(a,b,c)=>{a.save(),a.translate(b,c),a.beginPath(),a.moveTo(0,0),a.bezierCurveTo(2,-10,-20,-25,0,-30),a.bezierCurveTo(20,-25,-2,-10,0,0),a.fillStyle='orange',a.fill(),a.strokeStyle='black',a.lineWidth=1.5,a.stroke(),a.beginPath(),a.arc(0,-21,3,0,2*Math.PI),a.closePath(),a.fillStyle='black',a.fill(),a.restore(),[].push({drawPin:{x:b,y:c}})},drawCircle=(a,b,c,d)=>{a.beginPath(),a.arc(`${b+2}`,`${c+6}`,`${d}`,0,2*Math.PI),a.closePath(),a.fill(),a.stroke(),[].push({circle:{x:b,y:c}})},drawSquare=(a,b,c,d,e)=>{a.beginPath(),a.rect(`${b-50}`,`${c-50}`,`${d}`,`${e}`),a.closePath(),a.fill(),a.stroke(),[].push({square:{x:b,y:c}})},drawText=(a,b,c)=>{context.font='2rem Monaco',context.fillText(`${a}`,`${b-15}`,`${c+15}`),[].push({content:a,x:b,y:c})},saveCanvas=(a,b)=>{const c=a.toDataURL(),d=document.querySelector(`${b}`);a.src=c,d.addEventListener('click',()=>{return _this.href=c,_this.download='canvas.png',!1})},downloadCanvas=(a,b,c)=>{a.href=document.querySelector(b).toDataURL(),a.download=c},clearCanvas=(a,b)=>{a.width=a.width,b.drawImage(bgImage,0,0,screen.width,screen.height)},draw=(a,b,c,d)=>{switch(drawing){case'circle':drawCircle(b,c,d,20);break;case'square':drawSquare(b,c,d,100,100);break;case'pin':drawText('Lucas',c,d),drawPin(b,c,d,20);break;case'free':drawFree(b,c,d);break;default:console.log('Selecione um bot\xE3o para desenha');}},canvas=config('#screen',screenSize.width,screenSize.height),screen=canvas.canvas,context=canvas.context,bgImage=new Image;bgImage.src='assets/images/planta.jpg',window.onload=()=>{context.drawImage(bgImage,0,0,screen.width,screen.height)};let drawing='free';document.querySelector('.comment').addEventListener('click',()=>{drawing='pin'},!0),document.querySelector('.form_circle').addEventListener('click',()=>{drawing='circle'},!0),document.querySelector('.form_square').addEventListener('click',()=>{drawing='square'},!0),document.querySelector('.draw_free').addEventListener('click',()=>{drawing='free'},!0),document.querySelector('.download').addEventListener('click',()=>{const a=document.querySelector('.download');downloadCanvas(a,'#screen','test.png')},!1),document.querySelector('.clear_canvas').addEventListener('click',()=>{clearCanvas(screen,context)},!1),screen.addEventListener('click',(a)=>{const b=mousePosition(screen,a);draw(screen,context,b.x,b.y)},!0),drawFree(screen,context);